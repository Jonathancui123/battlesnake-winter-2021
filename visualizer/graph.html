<!DOCTYPE html>
<!-- HTML5 document type -->
<html>
  <head>
    <!-- use go-debug.js when developing and go.js when deploying -->
    <script src="https://unpkg.com/gojs/release/go-debug.js"></script>
  </head>
  <body>
    <!-- The DIV for a Diagram needs an explicit size or else we will not see anything.
     In this case we also add a background color so we can see that area. -->
<div id="myDiagramDiv"
     style="width:100vw; height:100vh; background-color: #DAE4E4;"></div>
  
  <script>
    // Change this number and refresh your page to see a diffferent turn
    const TURN_NUMBER = 1;

    var $ = go.GraphObject.make;
var myDiagram =
  $(go.Diagram, "myDiagramDiv",
    {
      "undoManager.isEnabled": true,
      layout: $(go.TreeLayout, // specify a Diagram.layout that arranges trees
                { angle: 90, layerSpacing: 35 })
    });

// the template we defined earlier
myDiagram.nodeTemplate =
  $(go.Node, "Horizontal",
    { background: "#44CCFF" },
    // $(go.Picture,
    //   { margin: 10, width: 50, height: 50, background: "red" },
    //   new go.Binding("source")),
    $(go.TextBlock, "Default Text",
      { margin: 12, stroke: "white", font: "bold 16px sans-serif" },
      new go.Binding("text", "name")),
    $(go.TextBlock, "Default Text 2",
      { margin: 12, stroke: "white", font: "12px sans-serif" },
      new go.Binding("text", "body"))
  );

var model = $(go.TreeModel);

const gameId = `${window.location.pathname.substring(1)}`;
const resourceUrl = `data/${gameId}`; 

console.log(resourceUrl)
fetch(resourceUrl)
  .then((response) => {
    console.log(response)
    return response.json()
  }).then((responseBody) => {
    console.log(responseBody) 
    // TODO: implement handling for visualizing different turns
    const turnNumberString = `turn_${TURN_NUMBER}`
    model.nodeDataArray = responseBody[turnNumberString];
    myDiagram.model = model;
  })
  .catch((err) => {
    console.error(err)
  });
      
      </script>
  </body>
</html>
